<!DOCTYPE html>
<html>
   <head>
      <meta charset="utf-8" />
      <title>My BCIT Project</title>
      <meta name="comp1800 boilerplate code" content="my bcit project" />
      <meta name="author" content="BCIT" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />

      <link
         href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
         rel="stylesheet"
         integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
         crossorigin="anonymous"
      />
      <link
         rel="stylesheet"
         href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
      />
      <link rel="stylesheet" href="./styles/my_style.css" />

      <!-- Boostrap JS CDN -->
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
      <script
         src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
         integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0"
         crossorigin="anonymous"
      ></script>

      <!-- Firebase 8 related CSS CDN -->
      <link
         type="text/css"
         rel="stylesheet"
         href="https://www.gstatic.com/firebasejs/ui/4.8.1/firebase-ui-auth.css"
      />

      <!-- Firebase 8 related JS CDN -->
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
      <script src="https://www.gstatic.com/firebasejs/ui/4.8.1/firebase-ui-auth.js"></script>

      <!-- Link to the api keys for your Firebase project -->
      <script src="./scripts/firebaseAPI.js"></script>

      <style>
         body {
            margin: 0;
            color: #2e323c;
            background: #f5f6fa;
            position: relative;
            height: 100%;
         }

         .account-settings .user-profile {
            margin: 0 0 1rem 0;
            padding-bottom: 1rem;
            text-align: center;
         }

         .account-settings .user-profile .user-avatar {
            margin: 0 0 1rem 0;
         }

         .account-settings .user-profile .user-avatar img {
            width: 90px;
            height: 90px;
            -webkit-border-radius: 100px;
            -moz-border-radius: 100px;
            border-radius: 100px;
         }

         .account-settings .user-profile h5.user-name {
            margin: 0 0 0.5rem 0;
         }

         .account-settings .user-profile h6.user-email {
            margin: 0;
            font-size: 90%;
            font-weight: 400;
            color: #9fa8b9;
         }

         .account-settings .about {
            margin: 2rem 0 0 0;
            text-align: center;
         }

         .account-settings .about h5 {
            margin: 0 0 15px 0;
            color: #007ae1;
         }

         .account-settings .about p {
            font-size: 80%;
         }

         .form-group {
            margin-top: 10px;
         }

         .form-control {
            border: 1px solid #cfd1d8;
            -webkit-border-radius: 2px;
            -moz-border-radius: 2px;
            border-radius: 2px;
            font-size: 70%;
            background: #ffffff;
            color: #2e323c;
         }

         .card {
            background: #ffffff;
            -webkit-border-radius: 5px;
            -moz-border-radius: 5px;
            border-radius: 5px;
            border: 0;
            margin-bottom: 1rem;
         }

         .text-primary {
            font-size: 100%;
         }
      </style>
   </head>

   <body>
      <br />
      <div class="container">
         <div class="row gutters">
            <div class="col-xl-3 col-lg-3 col-md-12 col-sm-12 col-12">
               <div class="card h-100">
                  <div class="card-body">
                     <div class="account-settings">
                        <div class="user-profile">
                           <div class="user-avatar">
                              <img
                                 src="https://st.depositphotos.com/2309453/4531/i/950/depositphotos_45316879-stock-photo-beautiful-elderly-lady-with-a.jpg"
                                 alt="Maxwell Admin"
                              />
                           </div>
                           <h5 class="user-name">Hello,<span id="name-goes-here"></span></h5>
                           <h6 class="user-email">
                              This is your profile page. Recording detailed
                              information will help us in the future.
                           </h6>
                        </div>
                        <div class="about">
                           <h5>About</h5>
                           <p>
                              Hope UCare products can bring you satisfaction and
                              happiness.
                           </p>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="col-xl-9 col-lg-9 col-md-12 col-sm-12 col-12">
               <div class="card h-100">
                  <div class="card-body">
                     <div class="row gutters">
                        <div
                           class="
                              col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12
                           "
                        >
                           <h6 class="mb-2 text-primary">USER INFORMATION</h6>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                           <div class="form-group">
                              <label for="phone">First name</label>
                              <input
                                 type="text"
                                 class="form-control"
                                 placeholder="Lucy"
                                 id="f_name"
                              />
                           </div>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                           <div class="form-group">
                              <label for="website">Last name</label>
                              <input
                                 type="url"
                                 class="form-control"
                                 placeholder="Jesse"
                                 id="l_name"
                              />
                           </div>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                           <div class="form-group">
                              <label for="fullName">Username</label>
                              <input
                                 type="text"
                                 class="form-control"
                                 placeholder="lucky.jesse"
                                 id="username"
                              />
                           </div>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                           <div class="form-group">
                              <label for="eMail">Email address</label>
                              <input
                                 type="email"
                                 class="form-control"
                                 placeholder="jesse@example.com"
                                 id="email"
                              />
                           </div>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                           <div class="form-group">
                              <label for="eMail">Phone</label>
                              <input
                                 type="email"
                                 class="form-control"
                                 placeholder="123-456-7890"
                                 id="phone"
                              />
                           </div>
                        </div>
                     </div>
                     <br />
                     <div class="row gutters">
                        <div
                           class="
                              col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12
                           "
                        >
                           <h6 class="mt-3 mb-2 text-primary">
                              CONTACT INFORMATION
                           </h6>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                           <div class="form-group">
                              <label for="Street">Address</label>
                              <input
                                 type="name"
                                 class="form-control"
                                 placeholder="Bld Mihail Kogalniceanu, nr. 8 Bl 1, Sc 1, Ap 09"
                              />
                           </div>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                           <div class="form-group">
                              <label for="ciTy">City</label>
                              <input
                                 type="name"
                                 class="form-control"
                                 placeholder="Richmond"
                              />
                           </div>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                           <div class="form-group">
                              <label for="sTate">Country</label>
                              <input
                                 type="text"
                                 class="form-control"
                                 placeholder="Canada"
                              />
                           </div>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                           <div class="form-group">
                              <label for="zIp">Postal Code</label>
                              <input
                                 type="text"
                                 class="form-control"
                                 placeholder="Postal Code"
                              />
                           </div>
                        </div>
                     </div>
                     <br />
                     <div class="row gutters">
                        <div
                           class="
                              col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12
                           "
                        >
                           <h6 class="mt-3 mb-2 text-primary">
                              FAMILY/GUARDIAN CONTACTS
                           </h6>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                           <div class="form-group">
                              <label for="Street">Relationship</label>
                              <input
                                 type="name"
                                 class="form-control"
                                 placeholder="eg. Their children"
                              />
                           </div>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                           <div class="form-group">
                              <label for="ciTy">Phone number</label>
                              <input
                                 type="name"
                                 class="form-control"
                                 placeholder="123-456-7890"
                              />
                           </div>
                        </div>
                     </div>
                     <br />
                     <div class="row gutters">
                        <div
                           class="
                              col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12
                           "
                        >
                           <h6 class="mt-3 mb-2 text-primary">ABOUT ME</h6>
                        </div>
                        <div>
                           <textarea
                              class="form-control"
                              placeholder="Leave a comment here"
                              id="floatingTextarea2"
                              style="height: 100px"
                           ></textarea>
                        </div>
                     </div>
                     <br />
                     <div class="row gutters">
                        <div
                           class="
                              col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12
                           "
                        >
                           <div class="text-right">
                              <button
                                 type="button"
                                 id="submit"
                                 name="submit"
                                 class="btn btn-secondary"
                                 onclick="editUserInfo()"
                              >
                                 Edit
                              </button>
                              <button
                                 type="button"
                                 name="submit"
                                 class="btn btn-primary"
                                 onclick="saveUserInfo()"
                              >
                                 Save
                              </button>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
      <script src="./scripts/my_script.js"></script>
      <script>
           function insertName() {
               firebase.auth().onAuthStateChanged(user => {
                   // Check if user is signed in:
                   if (user) {
                       // Do something for the current logged-in user here:
                       console.log(user.uid);
                       //go to the correct user document by referencing to the user uid
                       currentUser = db.collection("users").doc(user.uid);
                       //get the document for current user.
                       currentUser.get()
                           .then(userDoc => {
                               var user_Name = userDoc.data().name;
                               console.log(user_Name);
                               //method #1:  insert with html only
                               document.getElementById("name-goes-here").innerText = user_Name;    //using javascript
                               //method #2:  insert using jquery
                               //$("#name-goes-here").text(user_Name);                         //using jquery
                           })
                   } else {
                       // No user is signed in.
                   }
               });
           }
           insertName();
      </script>
      <script>
         var currentUser;

         function populateInfo() {
             firebase.auth().onAuthStateChanged(user => {
                 // Check if user is signed in:
                 if (user) {

                     //go to the correct user document by referencing to the user uid
                     currentUser = db.collection("users").doc(user.uid)
                     //get the document for current user.
                     currentUser.get()
                         .then(userDoc => {
                             //get the data fields of the user
                             var username = userDoc.data().name;
                             // console.log(userName);
                             var useremail = userDoc.data().email;
                             var userphone= userDoc.data().phone;
                             var f_name= userDoc.data().f_name;
                             var l_name= userDoc.data().l_name;

                             //if the data fields are not empty, then write them in to the form.
                             if (username!= null) {
                                 document.getElementById("username").value = username;
                             }
                             if (useremail != null) {
                                 document.getElementById("email").value = useremial;
                             }
                             if (userphone!= null) {
                                 document.getElementById("phone").value = userphone;
                             }
                             if (f_name!= null) {
                                 document.getElementById("f_name").value = f_name;
                             }
                             if (l_name!= null) {
                                 document.getElementById("l_name").value = l_name;
                             }
                         })
                 } else {
                     // No user is signed in.
                     console.log("No user is signed in");
                 }
             });
         }

         //call the function to run it
         populateInfo();


         function editUserInfo(){

             document.getElementById("personalInfoFields").disabled = false;
         }

         function saveUserInfo(){
             username = document.getElementById('username').value;
             email = document.getElementById('email').value;
             phone = document.getElementById('phone').value;
             f_name = document.getElementById('f_name').value;
             l_name = document.getElementById('l_name').value;

             // console.log("values are:", name, school, city)
             currentUser.update({
                first_name: f_name,
                last_name: l_name,
                 name: username,
                 email: email,
                 phone: phone


             })
             document.getElementById("personalInfoFields").disabled = true;

         }
     </script>
   </body>
</html>
